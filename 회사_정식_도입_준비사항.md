# 광동제약 방문예약 시스템 - 회사 정식 도입 및 운영 준비사항

> 본 문서는 kwangdong-site(광동제약 방문예약 시스템)를 회사에 정식 도입하고 운영하기 위해 필요한 준비사항을 상세히 정리한 것입니다.

---

## 목차

1. [진행 일정](#1-진행-일정)
2. [부서별 역할](#2-부서별-역할)
3. [직원 DB 연동 및 관리자 페이지 기능 추가](#3-직원-db-연동-및-관리자-페이지-기능-추가)
4. [서버 이전](#4-서버-이전)
5. [태블릿](#5-태블릿)
6. [각 공장 경비실 Wi-Fi](#6-각-공장-경비실-wi-fi)
7. [그룹웨어 링크 등록](#7-그룹웨어-링크-등록)
8. [추가 고려사항](#8-추가-고려사항)

---

## 1. 진행 일정

| 기간 | 작업 내용 |
|------|----------|
| ~2월 | 약관(사내 공식 약관), 로그인 및 권한관리, 관리자 페이지 구현 |
| ~2월 | 사용자 피드백 반영 수정 |
| ~2월 | 최종 예약 사이트 완성 |
| ~3월 | 서버 및 DB 연동 |
| ~3월 | 각 경비실 운영 환경 구축 (Wi-Fi, 태블릿) |
| ~3월 | 사용자 교육 및 운영 |
| ~3월 | 시범 운영 모니터링 및 오류 수정 |
| 4월 | 정식 운영 |

---

## 2. 부서별 역할

### 2.1 공장관리팀

- 임직원모드 내 관리자 페이지 기능 요구사항 정의
- 운영 시뮬레이션 및 사용자 교육

### 2.2 AI센터

- 서버 이전 및 서비스 연동 (Vercel + Supabase + Vercel Serverless)
- 직원검색 HR DB 연동
- 각 경비실 Wi-Fi 환경 및 태블릿 지원
- 방문자 예약 사이트 바로가기 그룹웨어 내 링크 주소 등록

---

## 3. 직원 DB 연동 및 관리자 페이지 기능 추가

**관련 일정:** ~2월 (관리자 페이지), ~3월 (서버/DB 연동 시 직원 DB 동기화)

### 3.1 현재 상태 분석

| 구분 | 현재 상태 | 비고 |
|------|----------|------|
| **담당자(managers)** | Supabase `managers` 테이블에 수동 입력 | 예약 시 담당자 검색용 |
| **임직원 권한(employee_permissions)** | `user_id` + `manager_id` 기반, 수동 설정 | Supabase Auth 사용자와 연결 |
| **관리자 탭(AdminTab)** | "추후 구현 예정" 플레이스홀더 | 기능 미구현 |
| **직원 DB** | 회사 인사/ERP DB와 연동 없음 | 독립 운영 |

### 3.2 직원 DB 연동 준비사항

#### 3.2.1 연동 방식 선택

| 방식 | 장점 | 단점 | 권장 상황 |
|------|------|------|----------|
| **API 연동** | 실시간 동기화, 단일 소스 | 인사 시스템 API 필요 | 인사/ERP 시스템이 REST API 제공 시 |
| **배치 동기화** | 구현 단순, 기존 시스템 영향 적음 | 실시간 아님 (일 1회 등) | CSV/Excel 정기 제공 가능 시 |
| **수동 관리** | 추가 개발 없음 | 관리 부담, 오류 가능성 | 소규모(50명 이하) |

#### 3.2.2 연동 시 필요한 직원 데이터

```
필수 필드:
- 사번 (employee_id) - 고유 식별자
- 이름 (name)
- 부서 (department)
- 직급/직책 (position)
- 연락처 (phone)
- 이메일 (email) - 로그인/연동용

선택 필드:
- 회사/법인 (company)
- 승인자 여부 (is_approver)
- 승인 레벨 (approver_level)
- 비활성 여부 (is_active)
```

#### 3.2.3 DB 스키마 확장 제안

```sql
-- managers 테이블에 employee_id 컬럼 추가 (인사 DB 연동용)
ALTER TABLE managers ADD COLUMN IF NOT EXISTS employee_id TEXT UNIQUE;

-- 직원 동기화 로그 테이블 (선택)
CREATE TABLE IF NOT EXISTS employee_sync_log (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  sync_type TEXT NOT NULL, -- 'full' | 'incremental'
  synced_at TIMESTAMPTZ DEFAULT NOW(),
  records_added INT DEFAULT 0,
  records_updated INT DEFAULT 0,
  records_deactivated INT DEFAULT 0,
  error_message TEXT
);
```

#### 3.2.4 인사 시스템별 연동 가이드

| 인사/ERP 시스템 | 연동 방법 | 비고 |
|-----------------|----------|------|
| **SAP** | SAP OData/RFC API | 전문 개발 필요 |
| **더존/영업관리** | REST API 또는 DB 직접 연결 | 제품별 상이 |
| **그룹웨어(다우, 토즈 등)** | LDAP/AD 연동 또는 API | 조직도 API 활용 |
| **Excel/CSV** | 정기 업로드 + 파싱 | Supabase Edge Function 또는 Vercel API로 처리 |

### 3.3 관리자 페이지 기능 추가

#### 3.3.1 필수 구현 기능 목록

| 기능 | 설명 | 우선순위 | 예상 공수 |
|------|------|----------|----------|
| **담당자(managers) CRUD** | 담당자 추가/수정/삭제/목록 조회 | 높음 | 2~3일 |
| **임직원 권한 관리** | can_approve, can_checkin, can_admin 설정 | 높음 | 2일 |
| **공지사항 관리** | 이미 API 존재, UI만 AdminTab에 통합 | 중간 | 1일 |
| **FAQ 관리** | 이미 API 존재, UI만 AdminTab에 통합 | 중간 | 1일 |
| **예약 통계/대시보드** | 일별/월별 예약 현황, 상태별 집계 | 중간 | 2일 |
| **SMS 발송 로그 조회** | sms_notifications 테이블 조회 | 낮음 | 0.5일 |
| **직원 DB 동기화** | 배치/API 연동 UI (연동 방식에 따라) | 높음 | 3~5일 |

#### 3.3.2 AdminTab 화면 구성 제안

```
[관리자 탭]
├── 대시보드
│   ├── 오늘 예약 현황 (요청/승인/완료)
│   ├── 최근 7일/30일 통계
│   └── SMS 발송 현황
├── 담당자 관리
│   ├── 담당자 목록 (검색, 필터)
│   ├── 담당자 추가/수정/삭제
│   └── 승인자 지정 (is_approver, approver_level)
├── 권한 관리
│   ├── 임직원 권한 목록
│   ├── 사용자별 권한 설정 (can_approve, can_checkin, can_admin)
│   └── manager_id ↔ user_id 매핑
├── 콘텐츠 관리
│   ├── 공지사항 (등록/수정/삭제/고정)
│   └── FAQ (등록/수정/삭제/순서)
├── 직원 동기화 (연동 시)
│   ├── 수동 동기화 실행
│   ├── 동기화 로그 조회
│   └── 매핑 오류/경고 확인
└── 시스템 설정
    ├── SMS 발송 설정 (SOLAPI 키 등)
    └── 예약번호 형식 등
```

#### 3.3.3 권한 체계 정리

| 역할 | can_approve | can_checkin | can_admin |
|------|-------------|-------------|-----------|
| **경비실** | ❌ | ✅ | ❌ |
| **부서 담당자** | ✅ | ❌ | ❌ |
| **부서 승인자** | ✅ | ❌ | ❌ |
| **시스템 관리자** | ✅ | ✅ | ✅ |

### 3.4 작업 순서 제안

1. **Phase 1 (~2월)**  
   - AdminTab에 담당자 CRUD, 권한 관리 UI 구현  
   - 공지사항/FAQ 관리 UI 통합  

2. **Phase 2 (~2월)**  
   - 예약 통계 대시보드  
   - SMS 로그 조회  

3. **Phase 3 (~3월)**  
   - 인사 DB 연동 방식 확정  
   - 배치/API 연동 개발 및 직원 동기화 UI  

---

## 4. 서버 이전

**관련 일정:** ~3월 (서버 및 DB 연동)

### 4.1 현재 인프라

| 구성요소 | 현재 | 비고 |
|----------|------|------|
| **프론트엔드** | Vercel | GitHub 연동 자동 배포 |
| **백엔드/DB** | Supabase Cloud | 프로젝트 ID: esrvexhyrpwwyjpjeuqi |
| **SMS** | Vercel Serverless (api/send-sms.js) → SOLAPI | |

### 4.2 서버 이전 시나리오

#### 시나리오 A: 회사 자체 서버로 완전 이전

| 항목 | 준비사항 |
|------|----------|
| **웹 호스팅** | Nginx/Apache 또는 Node.js 서버, SSL 인증서 |
| **DB** | PostgreSQL 설치, Supabase 데이터 마이그레이션 |
| **인증** | Supabase Auth → 자체 Auth 또는 Keycloak 등 |
| **스토리지** | Supabase Storage → S3 또는 로컬 스토리지 |
| **도메인** | 회사 도메인 (예: visit.kwangdong.co.kr) |
| **방화벽** | 443(HTTPS), 필요 시 80(HTTP→HTTPS 리다이렉트) |

**마이그레이션 체크리스트:**
- [ ] PostgreSQL 스키마 및 데이터 export/import
- [ ] RLS 정책, 함수, 트리거 이전
- [ ] 환경 변수(VITE_SUPABASE_*) → 새 백엔드 URL/키로 변경
- [ ] SMS API 엔드포인트 URL 변경
- [ ] DNS 및 SSL 설정

#### 시나리오 B: Vercel 유지 + Supabase만 이전

| 항목 | 준비사항 |
|------|----------|
| **DB** | 자체 PostgreSQL 또는 AWS RDS 등 |
| **Supabase 대체** | PostgREST 또는 직접 REST API 구축 |
| **인증** | Supabase Auth 유지 또는 JWT 기반 자체 인증 |

**참고:** Supabase는 DB + Auth + Realtime + Storage를 제공하므로, DB만 이전 시 Auth/Realtime 등 별도 구현 필요.

#### 시나리오 C: 클라우드 전환 (AWS/GCP/NAVER Cloud 등)

| 항목 | 준비사항 |
|------|----------|
| **호스팅** | AWS Amplify, S3+CloudFront, GCP Cloud Run 등 |
| **DB** | RDS, Cloud SQL, Supabase 유지 등 |
| **비용** | 사용량 기반 과금 검토 |

### 4.3 권장안: 단계적 이전

1. **1단계 (현재)**  
   - Vercel + Supabase 유지  
   - 도메인만 회사 도메인으로 연결 (CNAME)  

2. **2단계 (필요 시)**  
   - Supabase Pro 플랜 검토 (데이터 국내 리전, SLA 등)  
   - 또는 Supabase Self-hosted (회사 서버)  

3. **3단계 (보안/규정 요구 시)**  
   - 완전 온프레미스 또는 회사 전용 클라우드로 이전  

### 4.4 서버 이전 시 주의사항

- **다운타임 최소화:** 새 환경에서 사전 테스트 후, DNS/배포를 한 번에 전환
- **백업:** 이전 전 Supabase 전체 백업 (SQL dump)
- **롤백 계획:** 문제 시 기존 URL/설정으로 즉시 복귀 가능하도록 준비

---

## 5. 태블릿

**관련 일정:** ~3월 (각 경비실 운영 환경 구축)

### 5.1 사용 목적

- **경비실 방문 수속:** QR 코드 스캔, 예약 확인, 체크인 처리
- **임직원 모드:** 예약 승인, 방문 수속 탭 접근

### 5.2 태블릿 사양 제안

| 항목 | 권장 사양 | 비고 |
|------|----------|------|
| **화면** | 10인치 이상 | QR 스캔 시 가독성 |
| **카메라** | 후면 카메라 (QR 스캔용) | 필수 |
| **OS** | Android 10+ 또는 iPadOS 14+ | 브라우저 호환성 |
| **RAM** | 4GB 이상 | 멀티탭, 카메라 동시 사용 |
| **저장공간** | 32GB 이상 | OS + 앱 업데이트 여유 |
| **배터리** | 8시간 이상 연속 사용 | 교대 근무 고려 |
| **네트워크** | Wi-Fi 5 (802.11ac) 이상 | 경비실 Wi-Fi 연동 |

### 5.3 제품 예시 (참고)

| 제품 | 화면 | 가격대 | 비고 |
|------|------|--------|------|
| Samsung Galaxy Tab A9+ | 11인치 | 약 40만원대 | Android, 카메라 보유 |
| iPad (10세대) | 10.9인치 | 약 60만원대 | iPadOS, 안정적 |
| Lenovo Tab M10 Plus | 10.6인치 | 약 30만원대 | Android, 가성비 |
| 공장용 산업용 태블릿 | 10~12인치 | 50~100만원대 | 내구성, 고정형 설치 |

### 5.4 태블릿 설정 가이드

1. **키오스크 모드 (선택)**  
   - 단일 앱만 실행되도록 설정 (Android: Screen Pinning, iPad: Guided Access)  
   - 실수로 앱 이탈 방지  

2. **자동 로그인/세션**  
   - 경비실 전용 계정으로 로그인 유지  
   - 세션 타임아웃 연장 설정 (Supabase Auth)  

3. **홈 화면 바로가기**  
   - 방문 수속 URL을 홈 화면에 추가 (PWA 또는 북마크)  
   - 예: `https://[도메인]/employee?tab=checkin`  

4. **카메라 권한**  
   - 브라우저에서 카메라 접근 허용  
   - HTTPS 필수 (카메라 API는 보안 컨텍스트 필요)  

5. **업데이트 정책**  
   - OS/브라우저 자동 업데이트 또는 정기 수동 업데이트  
   - 호환성 테스트 후 업데이트 적용  

### 5.5 공장별 태블릿 수량 산정

| 공장 | 경비실 수 | 태블릿 수 | 비고 |
|------|----------|----------|------|
| 본사 | 1~2 | 1~2대 | |
| 공장 A | 1 | 1대 | |
| 공장 B | 1 | 1대 | |
| … | … | … | |
| **합계** | | | 예비 1대 권장 |

---

## 6. 각 공장 경비실 Wi-Fi

**관련 일정:** ~3월 (각 경비실 운영 환경 구축)

### 6.1 요구사항

- 방문 수속 페이지 접속 (QR 스캔, 체크인)
- 임직원 모드 접속 (예약 승인, 방문 수속)
- 안정적인 HTTPS 연결 (Supabase API, Vercel 호스팅)

### 6.2 네트워크 사양

| 항목 | 권장 사양 | 비고 |
|------|----------|------|
| **대역폭** | 최소 10Mbps 이상 | 동시 접속 2~5명 가정 |
| **지연시간** | 100ms 이하 | 실시간 API 응답 |
| **안정성** | 99% 이상 가동률 | 업무 연속성 |
| **보안** | WPA2/WPA3, 비밀번호 관리 | 내부망 분리 권장 |

### 6.3 구성 제안

```
[인터넷]
    │
[회사 방화벽/게이트웨이]
    │
[경비실 전용 Wi-Fi SSID]
    │
├── 공장1 경비실 AP
├── 공장2 경비실 AP
└── 본사 경비실 AP
```

### 6.4 체크리스트 (공장별)

| 항목 | 확인 |
|------|------|
| 경비실에 Wi-Fi AP 설치 여부 | ☐ |
| SSID/비밀번호 문서화 및 경비실 공유 | ☐ |
| 회사 방화벽에서 방문예약 도메인 허용 | ☐ |
| Supabase API 도메인 허용 (*.supabase.co) | ☐ |
| Vercel/배포 도메인 허용 | ☐ |
| SMS API (SOLAPI) 호출 허용 (필요 시) | ☐ |
| 신호 강도 측정 (경비실 책상 위치) | ☐ |
| 예비 회선 또는 LTE 백업 검토 | ☐ |

### 6.5 방화벽 허용 도메인 목록

```
# 웹사이트
*.vercel.app (또는 회사 도메인)
[배포 도메인]

# Supabase
*.supabase.co
*.supabase.in

# 기타 (CDN, 폰트 등)
*.googleapis.com
*.gstatic.com
```

### 6.6 문제 발생 시 점검 사항

1. **접속 불가**  
   - Wi-Fi 연결 확인  
   - 방화벽/프록시 차단 여부  
   - DNS 해석 확인 (nslookup, ping)  

2. **느린 응답**  
   - 대역폭 측정  
   - 동시 접속 수 확인  
   - AP 과부하 여부  

3. **간헐적 끊김**  
   - AP 위치/신호 강도  
   - 채널 간섭 (2.4GHz vs 5GHz)  
   - 장비 펌웨어 업데이트  

---

## 7. 그룹웨어 링크 등록

**담당:** AI센터  
**관련 일정:** ~3월 (서버/DB 연동 시점 또는 정식 운영 전)

### 7.1 등록 목적

- 임직원이 그룹웨어에서 바로 방문예약 사이트에 접근할 수 있도록 바로가기 제공
- 예약 신청, 예약현황 조회, 임직원모드 접근 편의성 향상

### 7.2 등록 정보

| 항목 | 내용 |
|------|------|
| **제목** | 광동제약 방문예약 |
| **URL** | 배포된 사이트 URL (예: https://visit.kwangdong.co.kr 또는 Vercel URL) |
| **아이콘/썸네일** | 선택 (로고 또는 favicon) |

### 7.3 노출 위치

- 그룹웨어 메인/업무메뉴/바로가기 등
- 사용 중인 그룹웨어 제품(다우, 토즈, 자체 구축 등)에 따라 등록 방법 상이

### 7.4 권한 설정

- **전체 임직원 공개:** 방문예약 신청/조회가 필요한 모든 임직원
- **특정 부서만 공개:** (필요 시) 방문 담당 부서 위주로 제한

### 7.5 SSO 연동 (선택)

- 그룹웨어 SSO(Single Sign-On) 연동 시 임직원모드 로그인 생략 가능
- SSO 연동 여부는 AI센터와 그룹웨어 담당 부서 협의

---

## 8. 추가 고려사항

### 8.1 보안 및 인증

- **로그인 필수화:** 현재 임직원모드(`/employee`)는 로그인 없이 접근 가능. 정식 운영 전 **로그인 UI 및 접근 제어** 구현 필요.
- **그룹웨어 SSO:** 그룹웨어 링크 등록 시, SSO(Single Sign-On) 연동으로 로그인 생략 가능성 검토.

### 8.2 약관

- **사내 공식 약관 반영:** Agreement.tsx에 하드코딩된 약관을 법무/인사 검토 후 사내 공식 약관으로 교체. 회사명은 **광동제약**으로 통일.
- **관리자 페이지에서 약관 수정:** 약관 내용을 관리자 페이지에서 수정 가능하도록 할지 검토.

### 8.3 시범 운영 및 모니터링 (~3월)

- **모니터링 항목:** 일별 예약 건수, 승인/반려 비율, 체크인 성공률, SMS 발송 성공률
- **오류 수집:** Supabase 로그, Vercel Function 로그, 사용자 문의 채널
- **롤백 기준:** 중대 장애 시 수동 예약으로 전환하는 기준 사전 정의

### 8.4 운영 연속성

- **백업:** Supabase DB 정기 백업(일/주 단위), 백업 보관 기간
- **SMS:** SOLAPI 비용/한도, 발송 실패 시 대체 연락 방법
- **담당자 연락망:** 장애/문의 시 공장관리팀, AI센터 담당자 연락처 문서화

### 8.5 사용자 경험

- **오프라인 대응:** 경비실 Wi-Fi 장애 시 태블릿 LTE 백업 또는 수동 체크인 절차
- **접근성:** 태블릿 터치 UI, 글자 크기, 색 대비 등 확인

---

## 9. 예상 비용 (참고)

| 항목 | 예상 비용 | 비고 |
|------|----------|------|
| 관리자 기능 개발 | 인력 투입 (2~4주) | 내부/외주 |
| 직원 DB 연동 | 인력 + 인사 시스템 API 비용 | 시스템별 상이 |
| 서버 이전 | 0~수백만원 | 방식에 따라 |
| 태블릿 (공장 3곳 기준) | 90~180만원 | 3~4대, 예비 포함 |
| 경비실 Wi-Fi | 기존 인프라 활용 시 0 | 신규 AP 시 10~30만원/대 |
| 도메인/SSL | 연 1~3만원 | 회사 도메인 사용 시 0 |

---

## 10. 담당 부서 제안

| 준비사항 | 담당 부서 |
|----------|----------|
| 직원 DB 연동 | AI센터 / 인사 |
| 관리자 페이지 개발 | AI센터 |
| 관리자 페이지 요구사항 | 공장관리팀 |
| 서버 이전 | AI센터 |
| 태블릿 구매 및 설정 | 총무 / AI센터 |
| 경비실 Wi-Fi | AI센터 / 시설 |
| 그룹웨어 링크 등록 | AI센터 |
| 사용자 교육 | 공장관리팀 |

---

**문서 작성일:** 2025년 2월  
**대상 시스템:** kwangdong-site (광동제약 방문예약 시스템)
